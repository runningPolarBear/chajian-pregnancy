(function(g){var e=function(a,b){this.clientWidth=document.body.clientWidth;this.id=a;this.beginYear=b.year;this.beginMonth=b.month-1;this.beginDay=b.day;this.beginDate=new Date;this.beginDate.setFullYear(this.beginYear);this.beginDate.setMonth(this.beginMonth);this.beginDate.setDate(this.beginDay);this.nowDate=new Date;this.daytimes=864E5;this.pickDate=this.nowDate;this.fn=b.singleClickFn;this.pastdays=Math.round((this.nowDate.getTime()-this.beginDate.getTime())/this.daytimes+1);console.log((this.nowDate.getTime()-
this.beginDate.getTime())/this.daytimes);this.pages=Math.ceil(this.pastdays/7);this.weeks=Math.ceil(this.pastdays/7);this.futuredays=7*this.pages-this.pastdays;this.pregnancyStructure();this.move();this.liClick()};e.prototype.pregnancyStructure=function(){var a=document.getElementById(this.id);this.addStyle(a,{position:"relative",width:"100%"});this.headNode=document.createElement("div");this.addStyle(this.headNode,{width:"100%",height:"30px",font:'16px/30px "\u5fae\u8f6f\u96c5\u9ed1"',"margin-top":"20px",
overflow:"hidden"});this.headNode.innerHTML='<p style="float: left; padding: 0 5px; margin-left: 5px;">\u7b2c<span>'+this.weeks+'/40</span>\u5468</p><p style="float: right; background: #59AEFF; border-radius: 15px 0px 0px 15px; padding: 0 15px; color: white;">\u4eca\u5929</p>';this.headNode.lastChild.setAttribute("fanhui","fanhui");a.appendChild(this.headNode);this.progressNode=document.createElement("div");this.addStyle(this.progressNode,{width:"96%",height:"10px",background:"#ccc","margin-top":"10px",
"margin-left":"2%","border-radius":"5px"});this.progressNode.innerHTML='<div style="height: 100%; background: -webkit-linear-gradient(left, #FF5EA2, #FF9351); border-radius: 5px;"></div>';this.progressNode.firstChild.style.width=parseInt(this.weeks/40*100)+"%";a.appendChild(this.progressNode);this.dateNode=document.createElement("div");this.dateNode.innerHTML=this.nowDate.getFullYear()+"-"+(this.nowDate.getMonth()+1)+"-"+this.nowDate.getDate();this.addStyle(this.dateNode,{height:"30px",width:"100%",
font:"bold 18px/40px ''","text-align":"center",color:"#999"});a.appendChild(this.dateNode);this.arrowContainNode=document.createElement("div");this.addStyle(this.arrowContainNode,{overflow:"hidden"});var b=document.createElement("div");b.innerHTML="<";this.addStyle(b,{font:"bold 20px/80px ''","float":"left",width:"8%",height:"100%","text-align":"center"});this.arrowContainNode.appendChild(b);this.containNode=document.createElement("div");this.addStyle(this.containNode,{width:"84%",height:"80px",position:"relative",
overflow:"hidden","float":"left"});this.containNode.innerHTML='<ul class="pregnancy-detail" id="pregnancy-detail" style="right: 0; top: 0;"></ul>';this.moveNode=this.containNode.firstChild;this.moveNode.style.width=.84*this.clientWidth/7*(this.pastdays+this.futuredays)+"px";for(var d=this.pastdays;0<d;d--){b=document.createElement("li");b.setAttribute("class","pregnancy-days");b.innerHTML='<p class="pregnancy-date"></p><p class="pregnancy-zhou"></p>';if(1==d){this.changeClass(b,"pregnancy-active",
"add");var f=this.nowDate}else this.changeClass(b,"pregnancy-past","add"),f=new Date,f.setTime(this.nowDate.getTime()-this.daytimes*(d-1));b.firstChild.innerHTML=f.getDate();b.lastChild.innerHTML=this.getWeekday(f.getDay());b.style.width=.84*this.clientWidth/7+"px";b.setAttribute("timeStamp",f.getTime());this.moveNode.appendChild(b)}for(d=0;d<this.futuredays;d++)b=document.createElement("li"),b.setAttribute("class","pregnancy-days"),b.innerHTML='<p class="pregnancy-date"></p><p class="pregnancy-zhou"></p>',
this.changeClass(b,"pregnancy-future","add"),f=new Date,f.setTime(this.nowDate.getTime()+this.daytimes*(d+1)),b.firstChild.innerHTML=f.getDate(),b.lastChild.innerHTML=this.getWeekday(f.getDay()),b.style.width=.84*this.clientWidth/7+"px",this.moveNode.appendChild(b);this.arrowContainNode.appendChild(this.containNode);b=document.createElement("div");b.innerHTML=">";this.addStyle(b,{font:"bold 20px/80px ''","float":"right",width:"8%",height:"100%","text-align":"center"});this.arrowContainNode.appendChild(b);
a.appendChild(this.arrowContainNode)};e.prototype.move=function(){var a=this;this.moveNode.addEventListener("touchstart",function(b){function d(b){b=b||g.event;b.preventDefault();c=!0;a.moveX=b.targetTouches[0].clientX;a.moveY=b.targetTouches[0].clientY;b=a.moveX-a.startX;isScrolling=Math.abs(b)<Math.abs(a.moveY-a.startY)?1:0;1!=isScrolling&&(a.moveDis=h-b,a.moveNode.style.right=a.moveDis+"px")}function f(b){a.moveNode.removeEventListener("touchmove",d);a.moveNode.removeEventListener("touchend",f);
c&&(Math.abs(a.moveX-a.startX)>.336*a.clientWidth&&(a.moveX>a.startX&&1<a.pages?--a.pages:a.moveX<a.startX&&a.pages<a.weeks&&(a.pages+=1),a.headNode.firstChild.firstChild.nextSibling.innerHTML=a.pages+"/40",a.progressNode.firstChild.style.width=parseInt(a.pages/40*100)+"%"),a.movePart(a.moveDis,-(a.weeks-a.pages)*a.clientWidth*.84,10,a.moveNode,"right"),a.moveDis=-(a.weeks-a.pages)*a.clientWidth*.84)}b=b||g.event;clearInterval(this.partTime);a.startX=b.targetTouches[0].clientX;a.startY=b.targetTouches[0].clientY;
a.moveNode.addEventListener("touchmove",d,!1);var c=!1,h=parseInt(a.moveNode.style.right);a.moveNode.addEventListener("touchend",f,!1)},!1)};e.prototype.getWeekday=function(a){if(0==a)return"\u5468\u65e5";if(1==a)return"\u5468\u4e00";if(2==a)return"\u5468\u4e8c";if(3==a)return"\u5468\u4e09";if(4==a)return"\u5468\u56db";if(5==a)return"\u5468\u4e94";if(6==a)return"\u5468\u516d"};e.prototype.addStyle=function(a,b){for(var d in b)a.style[d]=b[d]};e.prototype.changeClass=function(a,b,d,f){var c=a.getAttribute("class");
"del"==d?(c=c.replace(b,""),a.setAttribute("class",c)):"add"==d?(0>c.indexOf(b)&&(c=c.concat(" "+b)),a.setAttribute("class",c)):"change"==d&&0<=c.indexOf(b)&&(c=c.replace(b,f),a.setAttribute("class",c))};e.prototype.movePart=function(a,b,d,f,c,h){var e=this;clearInterval(this.partTime);if(b!=a){var g=(b-a)/d;this.partTime=setInterval(function(){a+=g;a<=b&&0>g?(clearInterval(e.partTime),a=b,h&&h()):a>=b&&0<g&&(clearInterval(e.partTime),a=b,h&&h());f.style[c]=a+"px"},20)}};e.prototype.liClick=function(){var a=
this;document.getElementById(this.id).addEventListener("click",function(b){b=b||g.event;var d=b.target||b.srcElement;(function(){var b;"LI"==d.tagName?b=d:"P"==d.tagName&&(b=d.parentNode);if(b&&b.getAttribute("timeStamp")){a.changeClass(b,"pregnancy-past","change","pregnancy-active");for(var c=a.containNode.firstChild.childNodes,e=0;e<a.pastdays;e++)0<=c[e].getAttribute("class").indexOf("pregnancy-active")&&a.changeClass(c[e],"pregnancy-active","change","pregnancy-past");a.changeClass(b,"pregnancy-past",
"change","pregnancy-active");c=new Date;b=parseInt(b.getAttribute("timeStamp"));c.setTime(b);a.nowDate.getTime()==b?a.headNode.lastChild.innerHTML="\u4eca\u5929":a.headNode.lastChild.innerHTML="\u8fd4\u56de\u4eca\u5929";a.dateNode.innerHTML=c.getFullYear()+"-"+(c.getMonth()+1)+"-"+c.getDate();a.pickDate=c;a.fn&&a.fn()}})();(function(){var b;"fanhui"==d.getAttribute("fanhui")&&(b=d);if(b&&"\u8fd4\u56de\u4eca\u5929"==b.innerHTML){a.moveNode.style.right="0px";b=a.containNode.firstChild.childNodes;for(var c=
0;c<a.pastdays;c++)0<=b[c].getAttribute("class").indexOf("pregnancy-active")&&a.changeClass(b[c],"pregnancy-active","change","pregnancy-past");a.changeClass(b[a.pastdays-1],"pregnancy-past","change","pregnancy-active");a.progressNode.firstChild.style.width=parseInt(a.weeks/40*100)+"%";a.headNode.lastChild.innerHTML="\u4eca\u5929";a.headNode.firstChild.firstChild.nextSibling.innerHTML=a.weeks+"/40";a.dateNode.innerHTML=a.nowDate.getFullYear()+"-"+(a.nowDate.getMonth()+1)+"-"+a.nowDate.getDate();a.pages=
a.weeks;a.pickDate=a.nowDate;a.fn&&a.fn()}})()},!1)};"object"===typeof module&&module&&"object"===typeof module.exports&&(module.exports=e);g.Pregnancy=e})(window);